<div class="tab-pane" *ngIf="data.length > 0">

  <div class="row">
    <div class="col-md-12">
      <button type="button" class="btn btn-sm" value="Collapse"
              (click)="collapseAll()">{{isCollapseAll() ? 'Expand All' : 'Collapse All'}}</button>
      <button type="button" class="btn btn-sm" value="SelectAll"
              (click)="selectAll()">{{isSelectedAll() ? 'Deselect All' : 'Select All'}}</button>
    </div>

  </div>
  <div class="row">
    <div class="col-md-12">
      <table class="table table-striped capacity-table" [mfData]="data" #mf="mfDataTable">
        <thead class="thead-light">
        <tr>
          <th style="width:10px"></th>
          <th>
            System
          </th>
          <th [class.highlightColumn]="isCurrentColumn(0)">Physical Subs</th>
          <th [class.highlightColumn]="isCurrentColumn(1)">Physical Capacity</th>
          <th [class.highlightColumn]="isCurrentColumn(2)">Available Capacity</th>
          <th [class.highlightColumn]="isCurrentColumn(3)">Logical Used</th>
          <th [class.highlightColumn]="isCurrentColumn(4)">Physical Used</th>
          <th [class.highlightColumn]="isCurrentColumn(5)">Compression Ratio</th>
        </tr>
        </thead>
        <tbody *ngFor="let system of mf.data;let i = index;">
        <tr *ngIf="this.getSystemStatistics(system.name) == undefined">
          <td colspan="8">{{ system.name }}</td>
        </tr>
        <tr *ngIf="this.getSystemStatistics(system.name) !== undefined" (click)="addCollapsed(system.name)" [class.collapsed]="isCollapsed(system.name)">
          <td colspan="2">{{ system.name }}</td>
          <td>{{this.getSystemStatistics(system.name).physicalSubstitution.toFixed(2)}}</td>
          <td>{{this.getSystemStatistics(system.name).physicalCapacity.toFixed(2)}}</td>
          <td>{{this.getSystemStatistics(system.name).availableCapacity.toFixed(2)}}</td>
          <td>{{this.getSystemStatistics(system.name).logicalUsed.toFixed(2)}}</td>
          <td>{{this.getSystemStatistics(system.name).physicalUsed.toFixed(2)}}</td>
          <td>{{this.getSystemStatistics(system.name).compressionRatio.toFixed(2)}}</td>
        </tr>
        <tr *ngFor="let pool of mf.data[i].pools" class="collapsable">
          <td><input type="checkbox" [name]="pool.name" [checked]="isSelectedPool(pool.name)"
                     (click)="selectPool(pool.name, system.name)"></td>
          <td>{{pool.name}}</td>
          <td *ngFor="let metric of pool.metrics; let column=index;" (mouseout)="setCurrentColumn(-1)"
              (mouseover)="setCurrentColumn(column)"
              [class.highlightColumn]="isCurrentColumn(column)">{{metric.value}} {{metric.unit}}
          </td>
        </tr>
        </tbody>
        <tbody *ngIf="this.getSystemStatistics('all') !== undefined" >
          <tr class="sticky">
            <td></td>
            <td></td>
            <td>{{this.getSystemStatistics('all').physicalSubstitution.toFixed(2)}}</td>
            <td>{{this.getSystemStatistics('all').physicalCapacity.toFixed(2)}}</td>
            <td>{{this.getSystemStatistics('all').availableCapacity.toFixed(2)}}</td>
            <td>{{this.getSystemStatistics('all').logicalUsed.toFixed(2)}}</td>
            <td>{{this.getSystemStatistics('all').physicalUsed.toFixed(2)}}</td>
            <td>{{this.getSystemStatistics('all').compressionRatio.toFixed(2)}}</td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>
